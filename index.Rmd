---
title: "My Portfolio"
author: "Anne Leendertse"
date: "Spring 2023"
output:
  flexdashboard::flex_dashboard:
    storyboard: true
---

```{r}
library(tidyverse)
library(spotifyr)
library(plotly)
library(compmus)
library(tidyr)
library(reshape2)
```

```{r}
andy_shauf <- get_track_audio_features("15WJWyrI3c6aRuvbYgMcKv")
my_portfolio <- get_playlist_audio_features("", "3MxAsxThsrUCjU4QAplkg0")
my_portfolio2 <- get_playlist_audio_features("", "0nYReIA8L6ep3yZp00TLwf")
Home <- get_track_audio_features("2YonDH4haZzgbo3NjpIalE")

Home_num <- Home %>% select_if(is.numeric) %>% select(-time_signature, -key, -tempo, -duration_ms, -loudness)
andy_shauf_num <- andy_shauf %>% select_if(is.numeric)

my_portfolio2_num <- my_portfolio2 %>% select_if(is.numeric)
my_portfolio2_clean <- my_portfolio2_num %>% select(-track.disc_number, -track.disc_number, -track.popularity, -track.track_number, -track.album.total_tracks, -time_signature, -key, -tempo, -track.duration_ms, -loudness)

my_portfolio_clean_mean <- apply(my_portfolio2_clean, 2, mean) 

compare_influence_writing <- rbind(my_portfolio_clean_mean, Home_num)

compare_influence_writing <- t(compare_influence_writing )


colnames(compare_influence_writing)[2]  <- "My song" 
colnames(compare_influence_writing)[1]  <- "Mean of influence
songs" 

jahe <- data.frame(compare_influence_writing)




jahe.long <- melt(jahe)

namen <- rownames(jahe)
variables <- append(namen, rownames(jahe))


```

### Introduction

(I just changed my topic 2 days ago, so let me know what you think.)


Just three days ago, the debut single, "Home", of my band was released on Spotify, marking a significant moment in my journey as a songwriter. It's the first time that the public can openly listen to my music, and I'm feeling a mix of excitement and nerves as I await the response from listeners.

But the release of my song on Spotify also offers new possibilities beyond just reaching a wider audience. With the help of the Spotify API, I can analyze my song and gain insights into its musical characteristics.

As a songwriter, I'm always fascinated by the creative process and how other music shapes the songs we write. For this project, I'm curious to explore the ways in which different artists and genres have influenced my own music.

To do this, I plan to compare my debut song to my top songs of 2022 and identify any correlations or similarities. Which artists or songs have had the greatest impact on my writing, and have I unintentionally incorporated elements of other music into my work. In other words: have I maybe accidentally ripped someone off?

As a songwriter, I believe that understanding the creative influences behind our music can enhance our artistry and lead to new discoveries. This project offers a unique opportunity to delve deeper into the musical elements that shape my writing and explore the ways in which other artists and genres have impacted my work. I'm excited to embark on this journey of self-discovery and to share my findings with fellow music enthusiasts.



If you stumble upon this dashboard and you would like to see what the song, "Home", sounds like, here is the Spotify link:
https://open.spotify.com/track/2YonDH4haZzgbo3NjpIalE?si=324e6a2d4e424358





### Comparing numerical variables

```{r}
ggplot(jahe.long,aes(x=variables,value,fill=variable))+
     geom_bar(stat="identity",position="dodge") + theme(axis.text.x = element_text(angle = 90))
```

***

In the bar graph in red you can see the mean for all the variables of my 101 top songs of 2022. These variables are the ones that are ranked between 0 and 1 by Spotify. In blue you see these numbers for my song. They differ the most for accounstichness. 

### Chromatogram

#### The Chromatogram of my piece:

```{r}
Home <-
  get_tidy_audio_analysis("2YonDH4haZzgbo3NjpIalE") |>
  select(segments) |>
  unnest(segments) |>
  select(start, duration, pitches)

Home |>
  mutate(pitches = map(pitches, compmus_normalise, "euclidean")) |>
  compmus_gather_chroma() |> 
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude") +
  theme_minimal() +
  scale_fill_viridis_c()
```

***

Insert text here
